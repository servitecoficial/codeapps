<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Admin Servitec</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-dark text-white p-4">

<h2 class="mb-3">SERVITEC – ADMIN</h2>

<input id="room" class="form-control mb-2" placeholder="Sala (ej: servitec1)">
<input id="client" class="form-control mb-2" placeholder="Nombre del cliente">
<input id="code" class="form-control mb-2" placeholder="Código que quieras">

<select id="fileSelect" class="form-select mb-3">
  <option value="files/appMagmaplay10.apk">Magma</option>
  <option value="files/FullTv.apk">FullTv</option>
  <option value="files/tvclasica.apk">Tv Clasica</option>
  <option value="files/UgoosLauncher-1.4.11.apk">Ugloos</option>
  <option value="files/SmartTube_stable_30.82_universal.apk">SmartTube</option>
  <option value="files/blokada4-final.apk">Blokada</option>
    <option value="files/netfly_tv.apk">Netfly TV</option>
    <option value="files/tv-box">MXLtv</option>
</select>

<button class="btn btn-success w-100 mb-2" onclick="startHost()">INICIAR HOST</button>
<button class="btn btn-info w-100" onclick="sendConfig()" disabled id="sendBtn">
ENVIAR CONFIGURACIÓN
</button>

<script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>

<script>
let peer;
let conn;

function startHost(){
  const room = document.getElementById("room").value.trim();
  if(!room){
    alert("Ingresá una sala");
    return;
  }

  peer = new Peer(room);

  peer.on("open", id => {
    alert("Host activo: " + id);
  });

  peer.on("connection", connection => {
    conn = connection;
    document.getElementById("sendBtn").disabled = false;
    alert("Cliente conectado");
  });
}

function sendConfig(){

  const client = document.getElementById("client").value.trim();
  const code = document.getElementById("code").value.trim();
  const filePath = document.getElementById("fileSelect").value;
  const fileName = filePath.split("/").pop();

  if(!client || !code){
    alert("Completá todo");
    return;
  }

  conn.send({
    type: "config",
    clientName: client,
    code: code,
    filePath: filePath,
    fileName: fileName
  });

  alert("Configuración enviada al cliente");
}
</script>

</body>
</html>
